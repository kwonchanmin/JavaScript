<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
   <!-- Vue.js를 위한 CDN-->
   <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
   <!-- Vue 라우터를 위한 CDN -->
   <script src="https://unpkg.com/vue-router@3.5.3/dist/vue-router.js"></script>
   <!-- Axios를 위한 CDN -->
   <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>
<body>

  <div id="movie">
    <tr v-for="">
      <global-component-a></global-component-a>
      <global-component-b></global-component-b>
    </tr>

  </div>

  <script>
  
    Vue.component('global-component-a',{
      template : `<div>
        <logic-component-c></logic-component-c>
        <logic-component-d></logic-component-d>
      </div>`,
      components:{
        'logic-component-c' :{
          template :'<div></div>'
        },
        'logic-component-d' :{
            template :'<div>{{ }}</div>'
              
            }
        }
      

    })
    let eventBus = new Vue();
    Vue.component('global-component-b',{
      template : '<div> <logic-component-e v-on:info-movie="resultMovie"></logic-component-e> </div>',
      components:{
        'logic-component-e' :{
          template:`
          <div> 
            <input type=date>
            <button v-on:click="movieSearch">검색</button>
          </div>`,
          methods:{
            movieSearch:function() {
              // 영화진흥위원회 api 가져오기.
            axios({
              url:'http://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json',
              method : 'GET',
             params:{
                 key:'6e32c1eecd679c968eec7ee87f533a98',
                targetDt : '20230101'
              },
              responseType: 'json', // 기본값
              timeout:3000,                        
           }).then(function(result) { 
              eventBus.$emit('searchEvent',result)
           }).catch(function() {
              alert('ㅅㅂ')
           })
          }
        }
      }
    },
    methods : {
      resultMovie : function(result) {
        console.log(result)
      }
    }
    })
    new Vue({
      el :'#movie',
      created : function(){
        eventBus.$on('searchEvent',function(value){
          let arr = value.data.boxOfficeResult.dailyBoxOfficeList
          console.log(arr)
        })
      },
      data :{
      }
      
      })
      console.log(arr)
  </script>
</body>
</html>